

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon_ico.png">
  <link rel="icon" href="/img/favicon_ico.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="分享总结个人的学习路程">
  <meta name="author" content="屠雍">
  <meta name="keywords" content="PCB, 单片机, 物联网, 嵌入式, Java, Linux, Web前端">
  <meta name="description" content="什么叫架构？  作者：Yrion | 链接：cnblogs.com&#x2F;wyq178&#x2F;p&#x2F;12151160.html 这个知识分享的爆炸时代,鉴于 Java 生态的完整和繁荣,各种框架、中间件和工具包供我们使用。连新培训出来的人都知道 SSM,微服务、集群、多线程、队列、高并发等技术,技术的间隔性正变得越来越小,仿佛我们只需要按部就班的去使用别人说的框架等技术就可以解决问题。 如果刨除redis、ra">
<meta property="og:type" content="article">
<meta property="og:title" content="什么叫架构？">
<meta property="og:url" content="http://example.com/2021/10/13/%E4%BB%80%E4%B9%88%E5%8F%AB%E6%9E%B6%E6%9E%84/index.html">
<meta property="og:site_name" content="小贝比">
<meta property="og:description" content="什么叫架构？  作者：Yrion | 链接：cnblogs.com&#x2F;wyq178&#x2F;p&#x2F;12151160.html 这个知识分享的爆炸时代,鉴于 Java 生态的完整和繁荣,各种框架、中间件和工具包供我们使用。连新培训出来的人都知道 SSM,微服务、集群、多线程、队列、高并发等技术,技术的间隔性正变得越来越小,仿佛我们只需要按部就班的去使用别人说的框架等技术就可以解决问题。 如果刨除redis、ra">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/tytokongjian/image/raw/master/images/20210601111247.png">
<meta property="og:image" content="https://gitee.com/tytokongjian/image/raw/master/images/20210601111643.webp">
<meta property="og:image" content="https://gitee.com/tytokongjian/image/raw/master/images/20210601111744.webp">
<meta property="og:image" content="https://gitee.com/tytokongjian/image/raw/master/images/20210601111909.png">
<meta property="og:image" content="https://gitee.com/tytokongjian/image/raw/master/images/20210601112330.png">
<meta property="og:image" content="https://gitee.com/tytokongjian/image/raw/master/images/20210601112411.png">
<meta property="article:published_time" content="2021-10-13T14:19:14.129Z">
<meta property="article:modified_time" content="2021-10-13T14:09:15.372Z">
<meta property="article:author" content="屠雍">
<meta property="article:tag" content="设计架构">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://gitee.com/tytokongjian/image/raw/master/images/20210601111247.png">
  
  <title>什么叫架构？ - 小贝比</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/atom-one-dark.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.12","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname"}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>小贝比的个人博客</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/background7.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="什么叫架构？">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-10-13 22:19" pubdate>
        2021年10月13日 晚上
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      5.8k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      18 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">什么叫架构？</h1>
            
            <div class="markdown-body">
              <center><h2>什么叫架构？</h2></center>

<p><em>作者：Yrion | 链接：cnblogs.com/wyq178/p/12151160.html</em></p>
<p>这个知识分享的爆炸时代,鉴于 Java 生态的完整和繁荣,各种框架、中间件和工具包供我们使用。连新培训出来的人都知道 SSM,微服务、集群、多线程、队列、高并发等技术,技术的间隔性正变得越来越小,仿佛我们只需要按部就班的去使用别人说的框架等技术就可以解决问题。</p>
<p>如果刨除redis、rabbitmq、kafka、dubbo、springcloud这些具体的技术框架，你有没有静下心来真正思考过架构是什么呢？这些框架是究竟是扮演怎么样的角色？如果不说各种天花乱坠的概念，让你给架构下一个定义,你会选择如何去描述架构呢？</p>
<p>翻译翻译，什么是架构？</p>
<p><img src="https://gitee.com/tytokongjian/image/raw/master/images/20210601111247.png" srcset="/img/loading.gif" lazyload alt="图片"></p>
<p><strong>背景</strong>: 从业快 4 年.我记得在我刚从业的时候,当时流行的框架是 spring、struts2、hibernate,前端使用的是 jsp，业务也不是那么复杂，整个项目并发量并不大,QPS 都不会超过5,当时的做法所有的前端和后端放在一起部署,打成war包直接部署到centos上的tomcat上就可以运行了,这样完全可以承载实际生产环境的请求量,问题也不大。</p>
<p>后来当我换了一家公司,公司采用 dubbo 微服务化,所有的业务均被划分成了一个个服务来提供给接口调用,当时的业务场景也比以前的复杂,采用23台服务器分开部署,容纳的线上负载大概在几百万左右。</p>
<p>服务进行修改逻辑再也不用像以前那么麻烦需要把整个项目重新打包再部署了.之后就在微服务的路上走的更远了,所有的服务独立部署,打包成镜像文件成为 docke r实例，独立部署在 docker 的服务器上,结合git,部署、运维、开发的效率得到了迅速提升。</p>
<p><strong>目录</strong> </p>
<p>一：架构到底是什么</p>
<p>二：常用的架构技术</p>
<p>  2.1：分布式</p>
<p>  2.2：集群</p>
<p>  2.3：缓存</p>
<p>  2.4：队列</p>
<p>  2.5：多线程</p>
<p>  2.6：限流</p>
<p>  2.7：服务降级和熔断</p>
<p>三：安全性问题</p>
<p>  3.1 sql注入</p>
<p>  3.2 跨域攻击</p>
<p>  3.3：XSS攻击</p>
<p>四: 架构设计的误区</p>
<p>  4.1:为了高大上而设计出复杂的架构</p>
<p>  4.2:用技术可以解决一切问题</p>
<h3 id="一：架构到底是什么"><a href="#一：架构到底是什么" class="headerlink" title="一：架构到底是什么"></a>一：架构到底是什么</h3><p>架构到底是什么？首先来看一下维基百科对架构的解释:</p>
<p><strong>软件架构：</strong>是一个系统的草图。软件架构描述的对象是直接构成系统的抽象组件。各个组件之间的连接则明确和相对细致地描述组件之间的通讯。在实现阶段，这些抽象组件被细化为实际的组件，比如具体某个类或者对像。</p>
<p><strong>软件架构师：</strong>软件架构师定义和设计软件的模块化，模块之间的交互，用户界面风格，对外接口方法，创新的设计特性，以及高层事物的对象操作、逻辑和流程。</p>
<p>按照维基百科的解释：软件架构实则是各个组件的互相搭配和组件之间的相互配合,是抽象的高层事务的的逻辑流程。简单来说架构就是各个系统组件如何通讯、协调、以及控制操作的逻辑。</p>
<p>可以类比人体的结构来举个简单的例子来理解就是：人体是由心肝脾肺胃、耳鼻嘴等多个重要器官组成，各个器官各司其职,它们之间相互配合共同维持人的正常生活。这里的心、胃等就是整个人体架构的组件,血液就是数据,血管就是传输数据的媒介,人的皮肤和长相就是用户的界面风格，逻辑组织就是食物要首先进入胃去消化然后才会进入大肠，而不是进入肾脏。</p>
<p>按照这个解释，我们使用的kafka、redis、ssm、rabbitmq、xxljob等都是组件，这些组件各有各的作用，各自承担自己的责任去共同完成整个系统的高效流转.</p>
<h3 id="二：常用的架构技术"><a href="#二：常用的架构技术" class="headerlink" title="二：常用的架构技术"></a>二：常用的架构技术</h3><h4 id="2-1：分布式"><a href="#2-1：分布式" class="headerlink" title="2.1：分布式"></a>2.1：分布式</h4><p>分布式:将同一套业务代码按照业务功能或者自定义的维度拆分不同的子系统，各个系统分开部署,每个子系统叫做服务,每个服务之间一般通过rpc或者webservice来调用</p>
<p>2.1.1:分布式的优点</p>
<p>分布式的好处就是解耦了原系统，从而便于运维部署和水平扩展,提供软件的伸缩性,甚至服务可以通过不同的语言来实现.各个模块交给不同的人员去开发，每个人各司其职，出现问题也可以快速定位</p>
<p>2.1.1:分布式的缺点</p>
<p>分布式也并不是毫无缺点的,存在以下的问题:</p>
<p><strong>①</strong>：服务调用通过网络来调用,一般微服务之间使用rpc来调用的，而rpc的底层就是TCP协议，如果网络故障或者延迟高一点,那么服务调用就有出现超时的可能性,比如dubbo的话会出现RpcException</p>
<p><strong>②</strong>：分布式在业务体量比较小或者粒度划分的情况下就是一种灾难式开发，开发和运维的成本都会直线上升</p>
<p><strong>③</strong>：分布式的数据一致性和事务比较难以保障,业务目前使用最多的是两阶段提交2pc,需要本地事务和远程事务综合提交,性能比较差</p>
<p><strong>④</strong>：分布式session的维护在单体工程中是不需要考虑session的安全性的,而在分布式环境中就必须考虑如何去维护session的一致</p>
<p><strong>⑤：</strong>分布式事务问题**:**分布式下如何保证各个服务的数据一致性也是一种挑战,当程序出现异常崩溃的时候能够保证各个服务能够正常回滚是很重要的。</p>
<p>分布式最常见的技术:分布式缓存、分布式存储、分布式计算、分布式静态资源</p>
<h4 id="2-2：集群"><a href="#2-2：集群" class="headerlink" title="2.2：集群"></a>2.2：集群</h4><p>集群:同一套代码部署在多个服务器上,而多个服务器可以提供更多的cpu、内存、硬盘等资源，从而提升整理的处理请求能力。集群的每个服务器叫做节点,每个节点提供的是相同的服务,节点的关系只是一种简单的复制,具体是哪个节点处理,则是根据负载均衡策略来决定；</p>
<p>在网站的处理能力出现下滑的时候,简单的在集群中增加服务器台数就可以显著增加整体的数据量处理能力(不过存在上限)；</p>
<p>原理很简单:所谓**众人拾柴火焰高,**多台服务器一起聚合处理数据量和并发访问的能力肯定比单台服务器要高很多；在遇到请求处理的瓶颈时候,可以通过简单的增加服务器台数来提高并行处理的能力,不过需要注意的是增加服务器台数在出现大于某个数量之后性能会停滞不前。</p>
<p><img src="https://gitee.com/tytokongjian/image/raw/master/images/20210601111643.webp" srcset="/img/loading.gif" lazyload alt="图片"></p>
<h4 id="2-3：缓存"><a href="#2-3：缓存" class="headerlink" title="2.3：缓存"></a>2.3：缓存</h4><p>缓存是提高软件的性能第一手段，最有效和最具代表性的方法,缓存分为单机缓存和分布式缓存。最常见的分布式缓存技术为redis、memorycache等，单机缓存比如hashmap、concurrentHashmap、guava等<strong>。</strong>单机缓存的承载容量有限,而分布式缓存的伸缩性和的存储容量会比较可观，就算缓存的空间不足了，也可以通过增加服务器来扩展。</p>
<p>缓存最显著的作用有两个：①加快数据的访问速度 ②分担后端的数据访问和存储的负载能力,保护数据库</p>
<p><img src="https://gitee.com/tytokongjian/image/raw/master/images/20210601111744.webp" srcset="/img/loading.gif" lazyload alt="图片"></p>
<p>使用缓存需要注意以下几点：</p>
<p><strong>①: 缓存雪崩</strong></p>
<p>缓存雪崩指的是所有的缓存在统一时间全部失效，导致大量的请求直接涌入数据库,数据库被击垮。</p>
<p>解决缓存雪崩的方法：缓存过期值在一定的基础上设置随机值</p>
<p><strong>②: 缓存击穿</strong></p>
<p>缓存击穿是指某些热点key在某一时间全部失效了,导致大量的请求涌入后台DB数据库，解决缓存击穿的方法:热点数据设置永不过期</p>
<p><strong>③:缓存穿透</strong></p>
<p> 一直请求不存在的数据,最终走的还是数据库就是缓存穿透</p>
<p>解决缓存穿透的方法:采用布隆过滤器(bloomFilter)，布隆过滤会有一定的误差，但是可以晒选出一定不存在的数据，缺点是无法判定某个key是否确定存在。</p>
<h4 id="2-4：队列"><a href="#2-4：队列" class="headerlink" title="2.4：队列"></a>2.4：队列</h4><p>试想这样一个的高请求量场景:各大电商的双11,在双11的那一刻,有大量订单涌入,后端会接受请求，然后写入数据库,等待数据库的返回.如果请求量非常大的话,数据库读写IO就会阻塞,那么程序就会出现卡死,数据库崩溃等问题。</p>
<p>如果采用队列的话,将下单请求发送到队列中,然后立刻返回(可以按照业务决定,比如返回处理中，等到真正成功再通知用户)，这样就不需要等待后端必须返回成功。消费端可以按照请求的顺序平滑的去消费,缓解了高峰的请求,并且实现了请求下单和实现下单的解耦<strong>。</strong>从以下图可以看出使用队列以后处理起来比较平滑~</p>
<p><img src="https://gitee.com/tytokongjian/image/raw/master/images/20210601111909.png" srcset="/img/loading.gif" lazyload alt="图片"></p>
<h4 id="2-5：多线程"><a href="#2-5：多线程" class="headerlink" title="2.5：多线程"></a>2.5：多线程</h4><p>多线程真正的意义有两个①提高cpu的利用率 ②：加快程序执行效率，目前已经是多核的时代，服务器六核、八核屡见不鲜,在多核的cpu中如果使用单线程那么无疑是对多核cpu的浪费，多线程能够有效提高cpu利用的效率，多个任务分给多个cpu去处理,可以实现真正的并行处理。</p>
<p>如果在单核cpu中,只是cpu在不停的切换cpu时间。假设我们有十个表格的数据需要分析处理(计算密集型)，采用单线程需要一个个的轮询表格，而多线程在合理分配线程数的情况下就可以同时处理,提高开发的效率</p>
<h4 id="2-6：限流"><a href="#2-6：限流" class="headerlink" title="2.6：限流"></a>2.6：限流</h4><p>限流是面对高并发的利器之一，例如秒杀场景:在大量的请求涌入后台,QPS高达几十万，如果不能做到有效控制就可能导致请求击垮数据库,DB基本上是一个网站的命脉。缓存、队列、限流等方式的本质其实都是为了保护DB。限流的简单理解其实就是过滤掉无效的请求,将请求限制在一个可以控制的范围内,最常见的限流有以下方式： </p>
<p> <strong>①：</strong>Redis限流</p>
<p>Redis限流的基本思路是采用redis的key过期策略,将业务id和业务值放入到redis中设置一定的过期时间，等请求再次进入的时候，如果能从redis获取到值，那么我就因为是重复性请求。Redis过滤限流是最基础的限流手段，适用于过滤同一个用户请求的场景</p>
<p><strong>②：</strong>令牌桶算法</p>
<p>令牌桶算法的思路是在一定的时间内生成以固定的速度生成有限个令牌数量放入桶中,所有的请求首先从令牌桶中去尝试获取令牌，如果能获取到就可以继续执行,否则请求就会被抛弃。Google开源的guava中有RateLimter可以实现单机限流,令牌桶算法是限流非常有效的手段.</p>
<p><strong>③:</strong> 漏桶算法</p>
<p>漏桶算法的基本原理是将请求直接存放在一个漏斗中,请求过多的话,那么就会漏斗就会溢出，溢出的请求则会被拒绝服务。漏桶算法可以控制端口的流量输出速率，平滑请求的突发流量，实现流量整形.</p>
<p>因为漏桶算法的漏出速率是有效的,因此漏桶算法相比于令牌桶算法有一个显著的缺点是无法应对突发性的流量.可令牌桶算法是可以的</p>
<p><strong>④: 滑动窗口</strong></p>
<p>http为了控制流量的速率采用的方法就是滑动窗口机制。如果要分布式限流,可采用阿里的Sentinel框架,其基本原理是滑动窗口机制，利用Entry映射资源来平滑的限流</p>
<p>此外还有nginx限流，比如使用参数来限制某一个ip的在时间范围内的访问频率。客户端限流：发起请求按钮点击后,在后面的几秒内(由业务决定)设置为disabled,这一操作步骤虽然很小，但是带来的限流作用很可观</p>
<h4 id="2-7：服务降级和熔断"><a href="#2-7：服务降级和熔断" class="headerlink" title="2.7：服务降级和熔断"></a>2.7：服务降级和熔断</h4><p>很多人会忽视这个问题,对自己设计出来的架构盲目自信，认为不可能出问题。而事实上,一旦随着微服务和分布式架构的持续推进，服务器会越来越多,宕机的概率和可能性会逐步提升，虽然出现宕机的可能性基本上很渺茫，不过也应该做好服务降级和熔断的准备，以防止那万分之一的概率宕机。假设有1000台服务器发生宕机的概率是0.001%，就因为存在0.001%的概率会导致我们的服务并非100%高可用。</p>
<p>服务的降级和熔断一般采用的是netfly(没错，就是那个美剧巨头公司)出的hystrix，可以实现服务熔断和降级</p>
<h3 id="三：安全性问题"><a href="#三：安全性问题" class="headerlink" title="三：安全性问题"></a>三：安全性问题</h3><p>安全性的问题总是不被重视,其实安全的问题要比我们想像的要严重的多.大公司每时每刻都会有不同程度被攻击者发起攻击,一旦被黑客获取到数据库信息,那么将会有丢失用户信息、服务器被植入木马病毒、服务瘫痪等不容小觑的危险</p>
<h4 id="3-1-sql注入"><a href="#3-1-sql注入" class="headerlink" title="3.1 sql注入"></a>3.1 sql注入</h4><p>sql注入是目前所有方式中最频繁也是最严重的攻击手段，sql注入如果被居心叵测的黑客攻击很可能整个数据库都会被删除掉,其情节和结果十分恶劣。</p>
<p>防止sql注入的有效方式就是采用jdbc提供的preparementStatement进行预编译，它能有效保证sql的整体结构不会被破坏，万一被sql攻击也可以在预编译阶段失败，而不会执行成功。</p>
<h4 id="3-2-跨域攻击"><a href="#3-2-跨域攻击" class="headerlink" title="3.2 跨域攻击"></a>3.2 跨域攻击</h4><p>与主站的域名、端口、协议不一致性的请求都可以理解为跨域访问，浏览器有同源策略：浏览器会限制来自于不同源的documet和脚本对当前的document读取或设置部分属性，但是比如src\form表单提交&lt; img &gt;&lt; iframe &gt;&lt; link &gt;是没有跨域限制的。</p>
<p>csrf攻击：登陆网站A,获取到了网站A的cookie用户信息，然后点击了一个恶意网站外链B,网站B可以利用csrf漏洞模拟A网站的用户信息去请求A的某些敏感接口，比如转账、发送消息、邮件、获取部分信息、发起恶意代码等。</p>
<p>如何防止csrf攻击：①接口请求加上随机的token值或者token约束的规则，或者是有时效性的token码。这样的话，外链去访问接口在拦截器中验证token是否有效，②在http的头部加入自定义参数：放到 HTTP 头中自定义的属性里。通过 Ajax，可以一次性给所有该类请求加上 csrftoken 这个 HTTP 头属性，并把 token 值放入其中</p>
<p>③减少使用get提交,get提交会降低门槛</p>
<h4 id="3-3：XSS攻击"><a href="#3-3：XSS攻击" class="headerlink" title="3.3：XSS攻击"></a>3.3：XSS攻击</h4><p>xss攻击指的是攻击者对包含有漏洞的服务器注入js代码,会诱使受害者打开攻击的服务器URL，其中里面的URL会包含一些恶意代码，比如植入病毒、添加广告片段代码、篡改接口信息等。</p>
<p>预防xss攻击的方法：对于用户提交的内容，需要<code>过滤任何有执行能力的脚本或者影响页面的CSS，</code></p>
<h3 id="四-架构设计的误区"><a href="#四-架构设计的误区" class="headerlink" title="四: 架构设计的误区"></a>四: 架构设计的误区</h3><h4 id="4-1-为了高大上而设计出复杂的架构"><a href="#4-1-为了高大上而设计出复杂的架构" class="headerlink" title="4.1:为了高大上而设计出复杂的架构"></a>4.1:为了高大上而设计出复杂的架构</h4><p>试想如果在业务体量不是特点大的情况下,如果一味的追求时髦,追求新颖,采用分布式微服务架构,那么将会增加业务开发的难度,为了维护大量的微服务而多出很多成本。好的架构一定是适应于自身的业务发展的,而高于业务的，它具有顺应业务发展的前瞻性。</p>
<h4 id="4-2-用技术可以解决一切问题"><a href="#4-2-用技术可以解决一切问题" class="headerlink" title="4.2:用技术可以解决一切问题"></a>4.2:用技术可以解决一切问题</h4><p>企图用技术解决一切问题,认为技术是一切的解决之道,是万能的,其实有的时候技术解决不了的问题可以用从业务角度来考虑解决。比如之前楼主做个售票系统，主要是卖某个知名景点的票的业务。</p>
<p>后期上线后发现很多人买了很多特价免费票，特价票是针对导游带领的团员的，每个导游每天只能买一张特价免费票和一张半价票，之后看数据发现了很多导游配了两张票，然后那张半价票被退掉，只剩下一张免费票被刷了。技术总监就决定查这部分数据是怎么回事？</p>
<p>结果发现部分人利用导游证这个特惠故意购买无价票，这个问题如何从技术上解决呢?如果不允许导游买特惠票不合理，不允许退票也不合理。技术上貌似没有好的手段去杜绝这个问题，只能从线下去处理。</p>
<p><strong>五：总结</strong></p>
<p><img src="https://gitee.com/tytokongjian/image/raw/master/images/20210601112330.png" srcset="/img/loading.gif" lazyload alt="图片">本篇文章的主要概略图我总结了一下，大概如下，其中包括分布式、集群、缓存、微服务、队列等.</p>
<p>架构的话题弥足长远和复杂,不是一篇简单的文章能描述清楚的。本篇文章只是提纲挈领以下，说实话也是蜻蜓点水，希望能起到抛砖引玉的效果,不过在工作中思考、在实践中总结学习，是有助于提高我们的内功心法的。</p>
<p><img src="https://gitee.com/tytokongjian/image/raw/master/images/20210601112411.png" srcset="/img/loading.gif" lazyload alt="图片"></p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E8%AE%BE%E8%AE%A1%E6%9E%B6%E6%9E%84/">设计架构</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E8%AE%BE%E8%AE%A1%E6%9E%B6%E6%9E%84/">设计架构</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/10/13/%E7%94%9F%E6%88%90%E8%AE%A2%E5%8D%9530%E5%88%86%E9%92%9F%E6%9C%AA%E6%94%AF%E4%BB%98%EF%BC%8C%E5%88%99%E8%87%AA%E5%8A%A8%E5%8F%96%E6%B6%88%EF%BC%8C%E8%AF%A5%E6%80%8E%E4%B9%88%E5%AE%9E%E7%8E%B0/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">生成订单30分钟未支付，则自动取消，该怎么实现</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/10/13/%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E5%A4%84%E7%90%86%E9%87%8D%E5%A4%8D%E8%AF%B7%E6%B1%82%E5%B9%B6%E5%8F%91%E8%AF%B7%E6%B1%82/">
                        <span class="hidden-mobile">如何优雅处理重复请求/并发请求？</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://github.com/xiaobeibi" target="_blank" rel="nofollow noopener"><span>Github</span></a> <i class="iconfont icon-love"></i> <a href="https://gitee.com/tytokongjian" target="_blank" rel="nofollow noopener"><span>Gitee</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
